show_progress(0.1, 0);
ui_print("# Mi Note 3 Pie GCamFix");
ui_print("# Version: v20");
ui_print("# Features/Fixes:");
ui_print("# - Camera2API enabler");
ui_print("# - EIS enabler (Electronic image Stabilization)");
ui_print("# - Front Camera Fix");
ui_print("# - TelePhoto Camera Packages List (Permissive Mode Needed)");
ui_print("# - 1080p 120 fps Slow Motion in GCam");
ui_print("# - Sound Stereo Record; HEVC Fix");
ui_print("# - Additional Features Activated in Device Features");
ui_print("# (By Engineer_Mode, Thanks to: Alexe070315, Dianlujitao, unCoRrUpTeD, GreatApo)");
ui_print("Extracting files...");
mount("MTD", "system", "/system");
package_extract_dir("system", "/system");
ui_print("Setting permissions...");
set_perm(0, 0, 0644, "/system/etc/device_features/jason.xml","/system/etc/device_features/jason.xml","/system/priv-app/MiuiExtraPhoto/MiuiExtraPhoto.apk","/system/priv-app/MiuiExtraPhoto/lib/arm64/libgallery_arcsoft_dualcam_refocus.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/libgallery_arcsoft_portrait_lighting.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/libgallery_arcsoft_portrait_lighting_c.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/libgallery_mpbase.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/libmibokeh_gallery.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/librefocus.so","/system/priv-app/MiuiExtraPhoto/lib/arm64/librefocus_mibokeh.so","/system/vendor/etc/media_codecs.xml","/system/vendor/etc/media_codecs_performance.xml","/system/vendor/etc/media_profiles.xml","/system/vendor/etc/media_profiles_vendor.xml","/system/vendor/etc/camera/jason_imx386_ofilm_chromatix.xml","/system/vendor/etc/camera/jason_imx386_semco_chromatix.xml","/system/vendor/etc/camera/jason_s5k3m3_ofilm_chromatix.xml","/system/vendor/etc/camera/jason_s5k3m3_semco_chromatix.xml","/system/vendor/etc/camera/jason_s5k3p8sp_sunny_chromatix.xml","/system/vendor/etc/permissions/android.hardware.camera.ar.xml","/system/vendor/etc/permissions/android.hardware.camera.flash-autofocus.xml","/system/vendor/etc/permissions/android.hardware.camera.front.xml","/system/vendor/etc/permissions/android.hardware.camera.full.xml","/system/vendor/etc/permissions/android.hardware.camera.raw.xml","/system/vendor/lib/libmmcamera_jason_s5k3p8sp_sunny.so");
ui_print("Enabling Camera2 API in build.prop...");
package_extract_dir("tmp", "/tmp");
set_perm(0, 0, 0777, "/tmp/mytweaks.sh");
run_program("/tmp/mytweaks.sh", "mytweak");
set_perm(0, 0, 0755, "/system/build.prop");
unmount("/system");